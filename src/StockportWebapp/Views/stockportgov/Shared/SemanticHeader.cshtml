@inject StockportWebapp.Utils.ILoggedInHelper loggedInHelper
@inject StockportWebapp.FeatureToggling.FeatureToggles featureToggles

@{
    var user = loggedInHelper.GetLoggedInPerson();
    var headerClass = !string.IsNullOrEmpty(user.Email) ? "logged-in" : string.Empty;
}

<div class="skip-to-main-content" role="navigation">
    <a href="#content">Skip to main content</a>
</div>
<div class="center-wrapper">
    <div id="header-logo">
        <a href="https://www.stockport.gov.uk">Stockport Metropolitan Borough Council Homepage</a>
    </div>
    <div class="@headerClass" id="header-my-account">
        @if (featureToggles.NameInHeader && !string.IsNullOrEmpty(user.Email))
        {
            <div class="menu-container">
                <div class="menu">
                    <p>Welcome @user.Name</p>
                    <span class="fa fa-user" aria-hidden="true"></span>
                    <a href="/dashboard">My Account</a>
                    <span class="fa fa-angle-down" aria-hidden="true"></span>
                </div>
                <nav class="menu-tooltip">
                    <span class="fa fa-caret-up" aria-hidden="true"></span>
                    @Html.ActionLink("My Account", "Index", "Dashboard")
                    @Html.ActionLink("Account settings", "Settings", "Account")
                    @Html.ActionLink("Sign out", "Logout", "Account", null, new { @class = "sign-out" })
                </nav>
            </div>
            <div class="modal">
                <input id="modal" type="checkbox" name="modal" />
                <label for="modal">
                    <span class="fa fa-user" aria-hidden="true"></span>
                    <span class="hidden">Open account menu</span>
                </label>
                <div class="modal-overlay">
                    <label for="modal" class="button button-outline button-close button-overlay">
                        <span class="fa fa-times" aria-hidden="true"></span>
                        Close
                    </label>
                    <nav class="mobile-menu">
                        <ul>
                            <li>@Html.ActionLink("My Account", "Index", "Dashboard")</li>
                            <li>@Html.ActionLink("Account settings", "Settings", "Account")</li>
                            <li>@Html.ActionLink("Sign out", "Logout", "Account", null, new { @class = "sign-out" })</li>
                        </ul>
                    </nav>
                </div>
            </div>
        }
        else
        {
            <a href="#" id="reciteMe" class="visuallyhidden"><span class="fa fa-headphones hide-on-mobile" aria-hidden="true"></span>Accessibility</a>
            <a id="form-myaccount-link" href="https://myaccount.stockport.gov.uk"><span class="fa fa-user" aria-hidden="true"></span>My Account</a>
        }
    </div>
    <partial name="HeaderSearchBar" />
</div>
<partial name="BrowserCheck" />

<script>
    require(['/assets/javascript/stockportgov/config.min.js'], function() {
        require(['startup.min', 'utils.min', 'reciteMe.min'],
            function(startup, utils, reciteMe) {
                reciteMe.Init();
                startup.Init();
                utils.Init();
            }
        );
    });
</script>