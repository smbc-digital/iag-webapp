@using Microsoft.AspNetCore.Html
@using System.Text.Json
@model PublicationSection
@{
    ViewData["Title"] = Model.Title;
    ViewData["Description"] = Model.MetaDescription;
    ViewData["og:title"] = Model.Title;
}

@foreach (JsonElement node in Model.Body.GetProperty("content").EnumerateArray())
{
    object rendered = RichTextRenderer.Render(node);

    if (rendered is EmbeddedPartial partial)
    {
        <partial name="@partial.PartialName" model="@partial.Model" view-data='@(new ViewDataDictionary(ViewData) { { "AllowTwo", true } })' />
    }
    else if (rendered is string html)
    {
        @Html.Raw(html)
    }
}