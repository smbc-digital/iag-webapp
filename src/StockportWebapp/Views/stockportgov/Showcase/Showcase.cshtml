@using StockportWebapp.ProcessedModels
@using StockportWebapp.FeatureToggling
@inject FeatureToggles FeatureToggles

@model ProcessedShowcase
@{
    ViewData["Title"] = Model.Title;
    ViewData["og:title"] = Model.Title;
    ViewData["Description"] = Model.Teaser;
    ViewData["Slug"] = Model.Slug;
    Layout = "../Shared/_Layout.cshtml";
    var titleHack = string.Empty;
    ViewData["EventsH2"] = true;
    ViewData["EventCategory"] = Model.EventCategory;
    ViewData["EventSubheading"] = Model.EventSubheading;
}
@section Breadcrumbs {
    @Html.Partial("Breadcrumb", Model.Breadcrumbs)
}

@if (!string.IsNullOrWhiteSpace(Model.HeroImageUrl))
{
<div class="showcase-hero-image" style="background-image: url(@Model.HeroImageUrl)">
    <div class="title-card">
        <h1>
            <span>@Model.Title</span>
        </h1>
        <div class="clearfix"><hr class="hero-image-divider" /> </div>
        <h2>
            <span>@Model.Teaser</span>
        </h2>
    </div>
</div>
}
else
{
    <div class="full-width-title">
        <div class="grid-container grid-parent grid-100">
            <div class="grid-100 tablet-grid-100 mobile-grid-100">
                <h1 class="full-width-title-with-button">@Model.Title</h1>
            </div>
        </div>
    </div>
    titleHack = "full-width-title-margin-fix";
}

@if (FeatureToggles.ShowcaseConsultations && Model.Consultations.Any())
{
    <div class="@titleHack alt-container-row">
        @Html.Partial("Consultations", Model.Consultations)
    </div>
    titleHack = string.Empty;
}

<div class="alt-container-row featured-items-wrapper">
    <h2>@Model.Subheading</h2>
    <div class="featured-topic-list">
        @{
            foreach (var item in Model.FeaturedItems)
            {
                <div class="grid-20 tablet-grid-25 mobile-grid-33 featured-topic">

                    <div class="featured-topic-content">
                        <a href="@item.NavigationLink">
                            <div class="featured-topic-icon">
                                <i class="@item.Icon si-default"></i>
                            </div>
                            <div class="featured-topic-name">@item.Title</div>
                        </a>
                        <p class="hide-on-mobile hide-on-tablet featured-topic-description">
                            @if (item.SubItems.Any())
                            {
                                <span>Including</span>
                            }
                            @foreach (var subItem in item.SubItems.Take(2))
                            {
                                <br />
                                <a href="@subItem.NavigationLink">@subItem.Title</a>
                            }
                        </p>
                    </div>

                </div>
            }
        }
    </div>
</div>

@if (Model.NewsArticle != null)
{
    <div class="@titleHack showcase-news alt-container-row">
        @Html.Partial("ShowcaseNewsArticle", Model)
    </div>
    titleHack = string.Empty;
}

@if (Model.Events != null && Model.Events.Any() && Model.NewsArticle == null)
{
    <div class="@titleHack showcase-events alt-container-row">
        @Html.Partial("ShowcaseEventCards", Model.Events)
    </div>
    titleHack = string.Empty;
}

@if (Model.SocialMediaLinks != null && Model.SocialMediaLinks.Any())
{
    <div class="@titleHack alt-container-row">
        @Html.Partial("ShowcaseSocialMediaLinks", Model.SocialMediaLinks)
    </div>
    titleHack = string.Empty;
}

@if (Model.Events != null && Model.Events.Any() && Model.NewsArticle != null)
{
    <div class="@titleHack showcase-events alt-container-row">
        @Html.Partial("ShowcaseEventCards", Model.Events.Take(3).ToList())
    </div>
    titleHack = string.Empty;
}
@if (!string.IsNullOrWhiteSpace(Model.Body) && !string.Equals("<p></p>\n", Model.Body))
{
    <div class="@titleHack alt-container-row">
        <div class="grid-container showcase-body">
            <div class="l-body-section-filled l-article-content grid-100 tablet-grid-100 mobile-grid-100 grid-parent">
                @if (!string.IsNullOrWhiteSpace(Model.BodySubheading))
                {
                    <div class="grid-100">
                        <h2 class="text-centre">@Model.BodySubheading</h2>
                    </div>
                }
                <div class="grid-100 grid-parent">
                    <article>
                        @Html.Raw(Model.Body)
                    </article>                   
                </div>

            </div>
        </div>
    </div>
    titleHack = string.Empty;
}

