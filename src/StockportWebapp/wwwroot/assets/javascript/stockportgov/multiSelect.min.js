define(["jquery"],function(e){var i,t,l=3,n="";"block"==e("#categoryListError").css("display")&&(e(".CategoriesList-select").addClass("input-validation-error"),e(".CategoriesList-select").css("margin-bottom","0px"));var a=function(i){var t=e("."+n+"-add","."+n+"-div:visible"),l=t[t.length-1];r()?(e(l).show(),e("#categoryListError").hide(),e(".CategoriesList-select").removeClass("input-validation-error"),e(".CategoriesList-select").css("margin-bottom","10px")):e(l).hide(),v(),c()},o=function(i){var t=e("#"+n).val()+"|";e("#"+n).val(t),c()},s=function(){var i=e("."+n+"-remove");e(i).show();var t=-1,l=0,a=e("."+n+"-div:visible"),o=e("select",e(a));e(o).each(function(i){null!==e(this).val()&&""!==e(this).val()&&(-1===t&&(t=i),l++)}),1===l&&e(e(i)[t]).hide(),1===a.length&&e(e(i)[0]).hide()},v=function(){for(var i=e("."+n+"-div:visible"),t="",l=0;l<i.length;l++){l>0&&(t+="|");var a=e("select",e(i)[l]);t+=e(a).val()}e("#"+n).val(t)},r=function(){var i=!0;return e("."+n+"-select:visible").each(function(){i=i&&null!==e(this).val()&&""!==e(this).val()}),i},c=function(){i=e("#"+n).val(),t=i.split("|");var h=i.length>l?l:i.length;h=0===h?h=1:h,t=t.slice(0,h),e("."+n+"-div").hide(),e("."+n+"-add").hide(),e("."+n+"-remove").hide(),e("."+n+"-select").val(""),e('option[value=""]',"."+n+"-select").show();for(var d=0;d<t.length;d++){var u=e("."+n+"-div")[d];if(void 0!==u){e(u).show();var f=e("."+n+"-select")[d];null!==t[d]&&t[d].length>0&&(e('option[value=""]',f).hide(),e(f).val(t[d])),e(f).off("change").on("change",function(){a()})}}e('option[value!=""]',"."+n+"-select").show(),e("."+n+"-select").each(function(i){var t=i,l=e(this).val();e("."+n+"-select").each(function(i){t!==i&&e('option[value="'+l+'"]',this).hide()})});var g=e("."+n+"-div:visible");for(d=0;d<g.length;d++){var p=e("."+n+"-add")[d];d===g.length-1&&g.length<l&&(r()&&e(p).show(),e(p).off("click").on("click",function(){o()}));var m=e("."+n+"-remove-link")[d];e(m).off("click").on("click",function(){e(this).parent().parent().hide(),v(),c()}),s()}};return{Init:function(i){l=e("#"+(n=i)+"-limit").val(),c()}}});