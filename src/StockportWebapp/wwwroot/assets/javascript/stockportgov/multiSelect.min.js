define(["jquery"],function(s){var v,r,c=3,h="";"block"==s("#categoryListError").css("display")&&(s(".CategoriesList-select").addClass("input-validation-error"),s(".CategoriesList-select").css("margin-bottom","0px"));var d=function(){var e=s("."+h+"-remove");s(e).show();var i=-1,t=0,l=s("."+h+"-div:visible"),a=s("select",s(l));s(a).each(function(e){null!==s(this).val()&&""!==s(this).val()&&(-1===i&&(i=e),t++)}),1===t&&s(s(e)[i]).hide(),1===l.length&&s(s(e)[0]).hide()},u=function(){for(var e=s("."+h+"-div:visible"),i="",t=0;t<e.length;t++){0<t&&(i+="|");var l=s("select",s(e)[t]);i+=s(l).val()}s("#"+h).val(i)},f=function(){var e=!0;return s("."+h+"-select:visible").each(function(){e=e&&null!==s(this).val()&&""!==s(this).val()}),e},g=function(){v=s("#"+h).val(),r=v.split("|");var e=v.length>c?c:v.length;e=0===e?e=1:e,r=r.slice(0,e),s("."+h+"-div").hide(),s("."+h+"-add").hide(),s("."+h+"-remove").hide(),s("."+h+"-select").val(""),s('option[value=""]',"."+h+"-select").show();for(var i=0;i<r.length;i++){var t=s("."+h+"-div")[i];if(void 0!==t){s(t).show();var l=s("."+h+"-select")[i];null!==r[i]&&0<r[i].length&&(s('option[value=""]',l).hide(),s(l).val(r[i])),s(l).off("change").on("change",function(){var e,i;e=s("."+h+"-add","."+h+"-div:visible"),i=e[e.length-1],f()?(s(i).show(),s("#categoryListError").hide(),s(".CategoriesList-select").removeClass("input-validation-error"),s(".CategoriesList-select").css("margin-bottom","10px")):s(i).hide(),u(),g()})}}s('option[value!=""]',"."+h+"-select").show(),s("."+h+"-select").each(function(e){var i=e,t=s(this).val();s("."+h+"-select").each(function(e){i!==e&&s('option[value="'+t+'"]',this).hide()})});var a=s("."+h+"-div:visible");for(i=0;i<a.length;i++){var n=s("."+h+"-add")[i];i===a.length-1&&a.length<c&&(f()&&s(n).show(),s(n).off("click").on("click",function(){var e;e=s("#"+h).val()+"|",s("#"+h).val(e),g()}));var o=s("."+h+"-remove-link")[i];s(o).off("click").on("click",function(){s(this).parent().parent().hide(),u(),g()}),d()}};return{Init:function(e){c=s("#"+(h=e)+"-limit").val(),g()}}});