define(["jquery","matchboxconfig"],function(t,e){var o=0,r=!0,i=!1,a=function(e,i){t.get("/cookies/add?slug="+e+"&cookieType="+i,function(t,e){r&&(o++,d())})},n=function(a,n){t.get("/cookies/remove?slug="+a+"&cookieType="+n,function(n,u){r&&(o--,d()),i&&(t("#item-card-"+a).remove(),0===t(".group-card").length&&(t("#no-results").show(),t("#favourites-list").hide()),e.Init())})},u=function(){t(".add-favourite").on("click",function(){var e=t(this).attr("data-slug"),o=t(this).attr("data-type");a(e,o),t("#add-favourite-"+e).addClass("hidden"),t("#remove-favourite-"+e).removeClass("hidden"),t("#print-favourite-group-item-"+e).removeClass("hidden")}),t(".remove-favourite").on("click",function(){var e=t(this).attr("data-slug"),o=t(this).attr("data-type");n(e,o),t("#add-favourite-"+e).removeClass("hidden"),t("#remove-favourite-"+e).addClass("hidden"),t("#print-favourite-group-item-"+e).addClass("hidden")})},s=function(){var t=window.location.href.toLowerCase().replace("http://","").replace("https://",""),e=t.split("/");if(e.length>1){var o=e[1];if(e.length>2&&("favourites"===e[2]||"manage"===e[2]))return"favourites"===e[2]&&(i=!0),r=!1,""}switch(o){case"groups":return"StockportWebapp.Models.Group";case"organisations":return"StockportWebapp.Models.Group"}return""},f=function(){var e=s();if(""!==e&&c("favourites")){var i=t.parseJSON(unescape(c("favourites"))),a=i[e];"undefined"!=typeof a&&t.get("/groups/favourites/get-count",function(t){r&&(o=t,d())})}},d=function(){0==o?t(".favourites-bar").hide():t(".favourites-bar").length>0&&(t(".count",".favourites-bar").html(o),t(".favourites-bar").css("display","block"))},c=function(t){for(var e=t+"=",o=document.cookie.split(";"),r=0;r<o.length;r++){for(var i=o[r];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return""},v=function(){u(),f()};return{Init:v}});