define(["jquery","matchboxconfig"],function(e,t){var r=0,o=!0,a=!1,i=function(t,a){e.get("/cookies/add?slug="+t+"&cookieType="+a,function(e,t){o&&(r++,d())})},n=function(i,n){e.get("/cookies/remove?slug="+i+"&cookieType="+n,function(n,s){o&&(r--,d()),a&&(e("#item-card-"+i).remove(),0===e(".group-card").length&&(e("#no-results").show(),e("#favourites-list").hide()),t.Init())})},s=function(){e(".add-favourite").on("click",function(){var t=e(this).attr("data-slug"),r=e(this).attr("data-type");i(t,r),e("#add-favourite-"+t).addClass("hidden"),e("#remove-favourite-"+t).removeClass("hidden"),e("#print-favourite-group-item-"+t).removeClass("hidden")}),e(".remove-favourite").on("click",function(){var t=e(this).attr("data-slug"),r=e(this).attr("data-type");n(t,r),e("#add-favourite-"+t).removeClass("hidden"),e("#remove-favourite-"+t).addClass("hidden"),e("#print-favourite-group-item-"+t).addClass("hidden")})},u=function(){var e=window.location.href.toLowerCase().replace("http://","").replace("https://",""),t=e.split("/");if(t.length>1){var r=t[1];if(t.length>2&&("favourites"===t[2]||"manage"===t[2]))return"favourites"===t[2]&&(a=!0),o=!1,""}switch(r){case"groups":return"StockportWebapp.Models.Group";case"organisations":return"StockportWebapp.Models.Group"}return""},f=function(){var t=u();if(""!==t&&c("favourites")){var o=e.parseJSON(unescape(c("favourites"))),a=o[t];"undefined"!=typeof a&&(r=a.length,d())}},d=function(){0==r?e("#favourites-bar").hide():e("#favourites-bar").length>0&&(e(".count","#favourites-bar").html(r),e("#favourites-bar").show())},c=function(e){for(var t=e+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var a=r[o];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return""},v=function(){e("#favourites-bar").show(),s(),f()};return{Init:v}});