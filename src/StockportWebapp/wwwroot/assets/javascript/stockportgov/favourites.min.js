define(["jquery"],function(t){var e=0,a=!1,r=function(r,n){t.get("/favourites/add?slug="+r+"&type="+n,function(t,r){a&&(e++,f())})},n=function(r,n){t.get("/favourites/remove?slug="+r+"&type="+n,function(t,r){a&&(e--,f())})},i=function(){t(".add-favourite").on("click",function(){var e=t(this).attr("data-slug"),a=t(this).attr("data-type");r(e,a),t("#add-favourite-"+e).addClass("hidden"),t("#remove-favourite-"+e).removeClass("hidden")}),t(".remove-favourite").on("click",function(){var e=t(this).attr("data-slug"),a=t(this).attr("data-type");n(e,a),t("#add-favourite-"+e).removeClass("hidden"),t("#remove-favourite-"+e).addClass("hidden")})},o=function(){var t=window.location.href.toLowerCase().replace("http://","").replace("https://",""),e=t.split("/");return e.length>1?e[1]:""},s=function(){var t=window.location.href.toLowerCase().replace("http://","").replace("https://",""),e=t.split("/");if(e.length>1){var a=e[1];if(e.length>2&&("favourites"===e[2]||"manage"===e[2]))return""}switch(a){case"groups":return"StockportWebapp.Models.Group"}return""},u=function(){var r=s();if(""!==r){var n=t.parseJSON(unescape(d("favourites"))),i=n[r];"undefined"!=typeof i&&(e=i.length,f(),a=!0)}},f=function(){0==e?t("#favourites-bar").hide():t("#favourites-bar").length>0?(t(".count","#favourites-bar").html(e),t("#favourites-bar").show()):(t("body").append('<div id="favourites-bar"><div class="grid-container grid-100"><i class="fa fa-star"></i><u><span class="count">'+e+"</span><span>&nbsp;favourites</span></u></div></div>"),t("#favourites-bar").animate({bottom:0},500).animate({bottom:-7},100).animate({bottom:0},100),t("#favourites-bar").on("click",function(){window.location.href="/"+o()+"/favourites"}))},d=function(t){for(var e=t+"=",a=document.cookie.split(";"),r=0;r<a.length;r++){for(var n=a[r];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""},c=function(){i(),u()};return{Init:c}});