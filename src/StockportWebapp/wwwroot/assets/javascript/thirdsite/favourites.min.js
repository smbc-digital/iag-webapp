define(["jquery","matchboxconfig"],function(t,a){var e=0,r=!0,i=!1,o=function(){t(".add-favourite").on("click",function(){var a=t(this).attr("data-slug"),i=t(this).attr("data-type");o=a,n=i,t.get("/favourites/add?slug="+o+"&type="+n,function(t,a){r&&(e++,s())});var o,n;t("#add-favourite-"+a).addClass("hidden"),t("#remove-favourite-"+a).removeClass("hidden")}),t(".remove-favourite").on("click",function(){var o=t(this).attr("data-slug"),n=t(this).attr("data-type");u=o,f=n,t.get("/favourites/remove?slug="+u+"&type="+f,function(o,n){r&&(e--,s()),i&&(t("#item-card-"+u).remove(),0===t(".group-card").length&&(t("#no-results").show(),t("#favourites-list").hide()),a.Init())});var u,f;t("#add-favourite-"+o).removeClass("hidden"),t("#remove-favourite-"+o).addClass("hidden")})},n=function(){var a=function(){var t=window.location.href.toLowerCase().replace("http://","").replace("https://","").split("/");if(t.length>1){var a=t[1];if(t.length>2&&("favourites"===t[2]||"manage"===t[2]))return"favourites"===t[2]&&(i=!0),r=!1,""}switch(a){case"groups":return"StockportWebapp.Models.Group"}return""}();if(""!==a&&u("favourites")){var o=t.parseJSON(unescape(u("favourites")))[a];void 0!==o&&(e=o.length,s())}},s=function(){0==e?t("#favourites-bar").hide():t("#favourites-bar").length>0?(t(".count","#favourites-bar").html(e),t("#favourites-bar").show()):(t("body").append('<div id="favourites-bar"><div class="grid-container grid-100"><i class="fa fa-star"></i><u><span class="count">'+e+"</span><span>&nbsp;favourites</span></u></div></div>"),t("#favourites-bar").animate({bottom:0},500).animate({bottom:-7},100).animate({bottom:0},100),t("#favourites-bar").on("click",function(){window.location.href="/"+function(){var t=window.location.href.toLowerCase().replace("http://","").replace("https://","").split("/");return t.length>1?t[1]:""}()+"/favourites"}))},u=function(t){for(var a=t+"=",e=document.cookie.split(";"),r=0;r<e.length;r++){for(var i=e[r];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(a))return i.substring(a.length,i.length)}return""};return{Init:function(){o(),n()}}});