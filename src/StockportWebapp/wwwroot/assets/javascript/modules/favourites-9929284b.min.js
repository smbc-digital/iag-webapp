define(["jquery","matchboxconfig"],function(o,a){var i=0,n=!0,s=!1,r=function(t,e){o.get("/cookies/add?slug="+t+"&cookieType="+e,function(t,e){n&&(i++,d())})},u=function(r,t){o.get("/cookies/remove?slug="+r+"&cookieType="+t,function(t,e){n&&(i--,d()),s&&(o("#item-card-"+r).remove(),0===o(".group-card").length&&(o("#no-results").show(),o("#favourites-list").hide()),a.Init())})},e=function(){var t=window.location.href.toLowerCase().replace("http://","").replace("https://","").split("/");if(1<t.length){var e=t[1];if(2<t.length&&("favourites"===t[2]||"manage"===t[2]))return"favourites"===t[2]&&(s=!0),n=!1,""}switch(e){case"groups":case"organisations":return"StockportWebapp.Models.Group"}return""},d=function(){0==i?o(".favourites-bar").hide():0<o(".favourites-bar").length&&(o(".count",".favourites-bar").html(i),o(".favourites-bar").css("display","block"))},c=function(t){for(var e=t+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var a=r[o];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return""};return{Init:function(){var t;o(".add-favourite a").on("click",function(){var t=o(this).attr("data-slug"),e=o(this).attr("data-type");r(t,e),o(".add-favourite").addClass("hidden"),o(".remove-favourite").removeClass("hidden"),o(".print-favourite-group-item").removeClass("hidden")}),o(".remove-favourite a").on("click",function(){var t=o(this).attr("data-slug"),e=o(this).attr("data-type");u(t,e),o(".add-favourite").removeClass("hidden"),o(".remove-favourite").addClass("hidden"),o(".print-favourite-group-item").addClass("hidden")}),""!==(t=e())&&c("favourites")&&void 0!==o.parseJSON(unescape(c("favourites")))[t]&&o.get("/groups/favourites/get-count",function(t){n&&(i=t,d())})}}});